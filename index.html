<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sheikh Zada — JWT Generator</title>
  <style>
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: #e2e8f0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .app {
      width: 100%;
      max-width: 900px;
      background: rgba(255,255,255,0.04);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 6px 24px rgba(0,0,0,0.4);
    }
    header {
      text-align: center;
      margin-bottom: 24px;
    }
    h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(90deg, #38bdf8, #34d399);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    p.lead {
      font-size: 14px;
      color: #94a3b8;
      margin-top: 6px;
    }
    textarea, input[type=text] {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      margin-top: 10px;
      background: rgba(255,255,255,0.05);
      color: #f1f5f9;
      font-size: 14px;
    }
    textarea { min-height: 100px; }
    .btn {
      margin-top: 14px;
      display: inline-block;
      padding: 10px 16px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(90deg,#34d399,#38bdf8);
      color: #032;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
    }
    .btn:hover { opacity: 0.9; }
    .progress { margin-top: 10px; font-size: 13px; color: #94a3b8; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
      font-size: 13px;
    }
    th, td {
      padding: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      text-align: left;
    }
    td.token {
      font-family: monospace;
      word-break: break-all;
    }
    .status-ok { color: #4ade80; }
    .status-err { color: #f87171; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Sheikh Zada — JWT Token Generator</h1>
      <p class="lead">Paste your <code>id.json</code> or lines like <em>uid,password</em>. Tokens will be generated using the API.</p>
    </header>

    <section>
      <textarea id="pasteArea" placeholder='Example: {"uid":"3993678816","password":"ABC"} or multiple lines: uid,password'></textarea>
      <input id="apiBase" type="text" value="https://jnl-gen-jwt.vercel.app/token" style="display:none">
      <button id="startBtn" class="btn">Generate Tokens</button>
      <div class="progress">Progress: <span id="progress">0</span></div>
      <div id="tableWrap" style="margin-top:12px;max-height:400px;overflow:auto"></div>
    </section>
  </div>

<script>
async function parseInput() {
  const txt = document.getElementById("pasteArea").value.trim();
  try {
    if (!txt) return [];
    if (txt.startsWith("[")) return JSON.parse(txt);
    if (txt.startsWith("{")) return [JSON.parse(txt)];
    return txt.split(/\n+/).map(line => {
      const [uid, password] = line.split(/,|\s+/);
      return { uid, password };
    });
  } catch (e) {
    alert("Invalid input format");
    return [];
  }
}

document.getElementById("startBtn").addEventListener("click", async () => {
  const data = await parseInput();
  if (!data.length) return alert("No input data");

  const base = document.getElementById("apiBase").value.trim();
  const proxy = "https://api.allorigins.win/raw?url="; // fixed working proxy

  const results = [];
  let done = 0;
  document.getElementById("progress").textContent = "0/" + data.length;

  for (let it of data) {
    try {
      const url = `${base}?uid=${encodeURIComponent(it.uid)}&password=${encodeURIComponent(it.password)}`;
      const fetchUrl = proxy + encodeURIComponent(url);

      const res = await fetch(fetchUrl);
      const json = await res.json();
      results.push(json);
    } catch (e) {
      results.push({ uid: it.uid, error: e.message });
    }
    done++;
    document.getElementById("progress").textContent = `${done}/${data.length}`;
  }

  const rows = results.map(r => `
    <tr>
      <td>${r.uid || "-"}</td>
      <td class="token">${r.token || r.error || "-"}</td>
      <td class="${r.status==="live"?"status-ok":"status-err"}">${r.status||"err"}</td>
    </tr>`).join("");

  document.getElementById("tableWrap").innerHTML =
    `<table><thead><tr><th>UID</th><th>Token/Error</th><th>Status</th></tr></thead><tbody>${rows}</tbody></table>`;
});
</script>
</body>
</html>
