<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sheikh Zada — JWT Generator</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#6ee7b7;--accent2:#60a5fa}
    body{margin:0;font-family:Inter,ui-sans-serif;background:#071027;color:#e6eef8;display:flex;justify-content:center;padding:20px}
    .app{max-width:1000px;width:100%;background:#0b1220;border-radius:12px;padding:20px;box-shadow:0 8px 30px rgba(0,0,0,0.5)}
    header{display:flex;align-items:center;gap:14px;margin-bottom:12px}
    .logo{width:62px;height:62px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;color:#032}
    h1{font-size:20px;margin:0}
    .card{background:rgba(255,255,255,0.02);padding:14px;border-radius:10px;margin-top:12px}
    input[type=text], textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-size:13px}
    textarea{min-height:100px;resize:vertical}
    .btn{padding:8px 12px;border:none;border-radius:8px;cursor:pointer;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#042;font-weight:600;margin:4px 0}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.1);color:var(--accent)}
    table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px}
    th,td{padding:6px 8px;border-bottom:1px solid rgba(255,255,255,0.05);word-break:break-all;text-align:left}
    .status-processing{color:#facc15}
    .status-success{color:#9ae6b4}
    .status-error{color:#f87171}
    footer{text-align:center;margin-top:14px;color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo">SZ</div>
      <div>
        <h1>Sheikh Zada — JWT Generator</h1>
      </div>
    </header>

    <div class="card">
      <h3>Input</h3>
      <input id="fileInput" type="file" accept="application/json,text/plain" class="btn ghost">
      <textarea id="pasteArea" placeholder='Paste JSON or uid,password lines here'></textarea>
      <div style="margin-top:10px">
        <button id="startBtn" class="btn">Generate</button>
      </div>
      <div style="margin-top:8px">Progress: <span id="progress">0</span></div>
    </div>

    <div class="card">
      <h3>✅ Live UIDs</h3>
      <div id="liveWrap"><div>No Live UID yet</div></div>
      <button id="downloadLive" class="btn ghost" style="display:none">Download Live Tokens</button>
    </div>

    <div class="card">
      <h3>❌ Dead UIDs</h3>
      <div id="deadWrap"><div>No Dead UID yet</div></div>
    </div>

    <footer>Sheikh Zada</footer>
  </div>

<script>
async function parseInput() {
  const txt = document.getElementById("pasteArea").value.trim();
  let parsed = [];
  if (txt) {
    try {
      if (txt.startsWith("[")) parsed = JSON.parse(txt);
      else if (txt.startsWith("{")) parsed = [JSON.parse(txt)];
      else parsed = txt.split(/\n+/).map(line => {
        const [uid, password] = line.split(/,|\s+/);
        return { uid, password };
      });
    } catch { alert("Invalid pasted data"); }
  }
  return parsed;
}

document.getElementById("fileInput").addEventListener("change", async (e) => {
  const file = e.target.files[0];
  if (!file) return;
  const text = await file.text();
  document.getElementById("pasteArea").value = text;
});

document.getElementById("startBtn").addEventListener("click", async () => {
  const data = await parseInput();
  if (!data.length) return alert("No input data");

  const base = "https://jnl-gen-jwt.vercel.app/token";
  const proxy = "https://api.allorigins.win/raw?url=";

  document.getElementById("progress").textContent = "0/" + data.length;

  const liveRows = [];
  const deadRows = [];

  let completed = 0;

  const updateTables = () => {
    document.getElementById("liveWrap").innerHTML =
      liveRows.length ? `<table><thead><tr><th>UID</th><th>Status</th><th>Live/Dead</th><th>Token</th></tr></thead>
        <tbody>${liveRows.join("")}</tbody></table>`
      : "<div>No Live UID yet</div>";

    document.getElementById("deadWrap").innerHTML =
      deadRows.length ? `<table><thead><tr><th>UID</th><th>Status</th><th>Live/Dead</th><th>Error</th></tr></thead>
        <tbody>${deadRows.join("")}</tbody></table>`
      : "<div>No Dead UID yet</div>";

    document.getElementById("progress").textContent = `${completed}/${data.length}`;
  };

  const promises = data.map(async (it) => {
    const uid = it.uid;
    deadRows.push(`<tr><td>${uid}</td><td class="status-processing">Processing...</td><td>-</td><td>-</td></tr>`);
    updateTables();

    try {
      const url = `${base}?uid=${encodeURIComponent(it.uid)}&password=${encodeURIComponent(it.password)}`;
      const res = await fetch(proxy + encodeURIComponent(url));
      let json;
      try { json = await res.json(); }
      catch { json = { token: await res.text() }; }

      const token = json.token || json.jwt || json.access_token;
      if (token) {
        liveRows.push(`<tr><td>${uid}</td><td class="status-success">Success</td><td>Live</td><td>${token}</td></tr>`);
      } else {
        deadRows.push(`<tr><td>${uid}</td><td class="status-error">Error</td><td>Dead</td><td>No token</td></tr>`);
      }
    } catch (e) {
      deadRows.push(`<tr><td>${uid}</td><td class="status-error">Error</td><td>Dead</td><td>${e.message}</td></tr>`);
    }

    completed++;
    updateTables();
  });

  await Promise.allSettled(promises);

  if (liveRows.length) {
    const btn = document.getElementById("downloadLive");
    btn.style.display = "inline-block";
    btn.onclick = () => {
      const text = liveRows.map(r => {
        const m = r.match(/<td>(.*?)<\/td><td.*?>.*?<\/td><td.*?>.*?<\/td><td>(.*?)<\/td>/);
        return m ? `${m[1]},${m[2]}` : "";
      }).join("\n");
      const blob = new Blob([text], { type:"text/plain" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "live_tokens.txt";
      a.click();
    };
  }
});
</script>
</body>
</html>
